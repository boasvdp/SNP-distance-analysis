[21:11:26] This is snippy 4.4.5
[21:11:26] Written by Torsten Seemann
[21:11:26] Obtained from https://github.com/tseemann/snippy
[21:11:26] Detected operating system: linux
[21:11:26] Enabling bundled linux tools.
[21:11:26] Found bwa - /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/bwa
[21:11:26] Found bcftools - /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/bcftools
[21:11:26] Found samtools - /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/samtools
[21:11:26] Found java - /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/java
[21:11:26] Found snpEff - /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/snpEff
[21:11:26] Found samclip - /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/samclip
[21:11:26] Found seqtk - /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/seqtk
[21:11:26] Found parallel - /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/parallel
[21:11:26] Found freebayes - /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/freebayes
[21:11:26] Found freebayes-parallel - /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/freebayes-parallel
[21:11:26] Found fasta_generate_regions.py - /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/fasta_generate_regions.py
[21:11:26] Found vcfstreamsort - /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/vcfstreamsort
[21:11:26] Found vcfuniq - /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/vcfuniq
[21:11:26] Found vcffirstheader - /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/vcffirstheader
[21:11:26] Found gzip - /bin/gzip
[21:11:26] Found vt - /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/vt
[21:11:26] Found snippy-vcf_to_tab - /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/snippy-vcf_to_tab
[21:11:26] Found snippy-vcf_report - /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/snippy-vcf_report
[21:11:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[21:11:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[21:11:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[21:11:28] Checking version: java -version is >= 1.8 - ok, have 1.8
[21:11:31] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[21:11:31] Checking version: bwa is >= 7.12 - ok, have 7.17
[21:11:31] Using reference: /project/vdputten/SNP_pipeline/input/references/ATCC25922.gbk
[21:11:31] Treating reference as 'genbank' format.
[21:11:31] Will use 8 CPU cores.
[21:11:31] Using read file: /project/vdputten/SNP_pipeline/output/trimmed_illumina/strain02_1_trimmed.fastq.gz
[21:11:31] Using read file: /project/vdputten/SNP_pipeline/output/trimmed_illumina/strain02_2_trimmed.fastq.gz
[21:11:31] Creating folder: output/snippy_out/strain02
[21:11:31] Changing working directory: output/snippy_out/strain02
[21:11:31] Creating reference folder: reference
[21:11:31] Extracting FASTA and GFF from reference.
[21:11:33] Wrote 3 sequences to ref.fa
[21:11:33] Wrote 4914 features to ref.gff
[21:11:33] Creating reference/snpeff.config
[21:11:33] Freebayes will process 15 chunks of 352690 bp, 8 chunks at a time.
[21:11:33] Using BAM RG (Read Group) ID: strain02
[21:11:33] Running: samtools faidx reference/ref.fa 2>> snps.log
[21:11:33] Running: bwa index reference/ref.fa 2>> snps.log
[21:11:36] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[21:11:36] Running: ln -sf reference/ref.fa . 2>> snps.log
[21:11:36] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[21:11:36] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[21:11:36] Running: snpEff build -c reference/snpeff.config -dataDir . -gff3 ref 2>> snps.log
[21:11:44] Running: bwa mem  -Y -M -R '@RG\tID:strain02\tSM:strain02' -t 8 reference/ref.fa /project/vdputten/SNP_pipeline/output/trimmed_illumina/strain02_1_trimmed.fastq.gz /project/vdputten/SNP_pipeline/output/trimmed_illumina/strain02_2_trimmed.fastq.gz | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /scratch --threads 7 -m 571M | samtools fixmate -m - - | samtools sort -l 0 -T /scratch --threads 7 -m 571M | samtools markdup -T /scratch -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 556956 sequences (80000144 bp)...
[M::process] read 556828 sequences (80000120 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (12, 214566, 22, 9)
[M::mem_pestat] analyzing insert size distribution for orientation FF...
[M::mem_pestat] (25, 50, 75) percentile: (110, 197, 617)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 1631)
[M::mem_pestat] mean and std.dev: (262.80, 217.09)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 2138)
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (147, 198, 262)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 492)
[M::mem_pestat] mean and std.dev: (209.61, 82.60)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 607)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (29, 291, 4068)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 12146)
[M::mem_pestat] mean and std.dev: (1985.23, 3262.34)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 16185)
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_pestat] skip orientation FF
[M::mem_pestat] skip orientation RF
[M::mem_process_seqs] Processed 556956 reads in 57.144 CPU sec, 8.555 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[M::process] read 557582 sequences (80000094 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (13, 214523, 19, 3)
[M::mem_pestat] analyzing insert size distribution for orientation FF...
[M::mem_pestat] (25, 50, 75) percentile: (34, 86, 270)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 742)
[M::mem_pestat] mean and std.dev: (120.33, 112.49)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 978)
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (147, 199, 263)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 495)
[M::mem_pestat] mean and std.dev: (210.10, 82.80)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 611)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (81, 156, 266)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 636)
[M::mem_pestat] mean and std.dev: (198.00, 161.91)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 846)
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_pestat] skip orientation FF
[M::mem_pestat] skip orientation RF
[M::mem_process_seqs] Processed 556828 reads in 57.888 CPU sec, 7.646 real sec
[samclip] Processed 600000 records...
[samclip] Processed 700000 records...
[samclip] Processed 800000 records...
[samclip] Processed 900000 records...
[samclip] Processed 1000000 records...
[samclip] Processed 1100000 records...
[M::process] read 557756 sequences (80000266 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (10, 214485, 29, 5)
[M::mem_pestat] analyzing insert size distribution for orientation FF...
[M::mem_pestat] (25, 50, 75) percentile: (91, 145, 184)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 370)
[M::mem_pestat] mean and std.dev: (127.50, 58.66)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 463)
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (146, 197, 261)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 491)
[M::mem_pestat] mean and std.dev: (208.92, 82.57)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 606)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (109, 224, 668)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 1786)
[M::mem_pestat] mean and std.dev: (259.96, 223.58)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 2345)
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_pestat] skip orientation FF
[M::mem_pestat] skip orientation RF
[M::mem_process_seqs] Processed 557582 reads in 57.724 CPU sec, 7.738 real sec
[samclip] Processed 1200000 records...
[samclip] Processed 1300000 records...
[samclip] Processed 1400000 records...
[samclip] Processed 1500000 records...
[samclip] Processed 1600000 records...
[M::process] read 557742 sequences (80000186 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (13, 214379, 33, 1)
[M::mem_pestat] analyzing insert size distribution for orientation FF...
[M::mem_pestat] (25, 50, 75) percentile: (75, 206, 2334)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 6852)
[M::mem_pestat] mean and std.dev: (757.00, 1012.81)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 9111)
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (146, 196, 260)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 488)
[M::mem_pestat] mean and std.dev: (207.87, 81.80)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 602)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (54, 161, 488)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 1356)
[M::mem_pestat] mean and std.dev: (275.56, 294.60)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 1790)
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_pestat] skip orientation FF
[M::mem_pestat] skip orientation RF
[M::mem_process_seqs] Processed 557756 reads in 57.740 CPU sec, 7.752 real sec
[samclip] Processed 1700000 records...
[samclip] Processed 1800000 records...
[samclip] Processed 1900000 records...
[samclip] Processed 2000000 records...
[samclip] Processed 2100000 records...
[samclip] Processed 2200000 records...
[M::process] read 559104 sequences (80000158 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (12, 215179, 25, 8)
[M::mem_pestat] analyzing insert size distribution for orientation FF...
[M::mem_pestat] (25, 50, 75) percentile: (64, 233, 4437)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 13183)
[M::mem_pestat] mean and std.dev: (2050.50, 3443.47)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 17556)
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (146, 197, 260)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 488)
[M::mem_pestat] mean and std.dev: (208.39, 82.07)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 602)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (65, 222, 480)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 1310)
[M::mem_pestat] mean and std.dev: (213.91, 171.11)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 1725)
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_pestat] skip orientation FF
[M::mem_pestat] skip orientation RF
[M::mem_process_seqs] Processed 557742 reads in 58.012 CPU sec, 7.801 real sec
[samclip] Processed 2300000 records...
[samclip] Processed 2400000 records...
[samclip] Processed 2500000 records...
[samclip] Processed 2600000 records...
[samclip] Processed 2700000 records...
[samclip] Processed 2800000 records...
[M::process] read 559492 sequences (80000132 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (9, 214826, 36, 1)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (144, 193, 256)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 480)
[M::mem_pestat] mean and std.dev: (205.08, 80.70)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 592)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (120, 222, 617)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 1611)
[M::mem_pestat] mean and std.dev: (289.32, 247.94)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 2108)
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_pestat] skip orientation RF
[M::mem_process_seqs] Processed 559104 reads in 57.400 CPU sec, 7.541 real sec
[samclip] Processed 2900000 records...
[samclip] Processed 3000000 records...
[samclip] Processed 3100000 records...
[samclip] Processed 3200000 records...
[samclip] Processed 3300000 records...
[M::process] read 559678 sequences (80000072 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (8, 215851, 32, 5)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (144, 194, 256)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 480)
[M::mem_pestat] mean and std.dev: (205.03, 80.81)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 592)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (76, 115, 292)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 724)
[M::mem_pestat] mean and std.dev: (165.66, 165.55)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 940)
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_pestat] skip orientation RF
[M::mem_process_seqs] Processed 559492 reads in 57.788 CPU sec, 7.632 real sec
[samclip] Processed 3400000 records...
[samclip] Processed 3500000 records...
[samclip] Processed 3600000 records...
[samclip] Processed 3700000 records...
[samclip] Processed 3800000 records...
[samclip] Processed 3900000 records...
[M::process] read 560380 sequences (80000218 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (10, 215463, 42, 5)
[M::mem_pestat] analyzing insert size distribution for orientation FF...
[M::mem_pestat] (25, 50, 75) percentile: (33, 225, 488)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 1398)
[M::mem_pestat] mean and std.dev: (195.38, 170.96)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 1853)
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (143, 193, 255)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 479)
[M::mem_pestat] mean and std.dev: (204.13, 80.40)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 591)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (89, 187, 544)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 1454)
[M::mem_pestat] mean and std.dev: (194.17, 179.35)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 1909)
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_pestat] skip orientation FF
[M::mem_pestat] skip orientation RF
[M::mem_process_seqs] Processed 559678 reads in 57.972 CPU sec, 7.762 real sec
[samclip] Processed 4000000 records...
[samclip] Processed 4100000 records...
[samclip] Processed 4200000 records...
[samclip] Processed 4300000 records...
[samclip] Processed 4400000 records...
[M::process] read 559200 sequences (80000218 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (14, 216119, 27, 4)
[M::mem_pestat] analyzing insert size distribution for orientation FF...
[M::mem_pestat] (25, 50, 75) percentile: (97, 517, 4226)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 12484)
[M::mem_pestat] mean and std.dev: (2076.71, 2295.23)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 16613)
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (143, 191, 253)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 473)
[M::mem_pestat] mean and std.dev: (202.84, 79.53)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 583)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (130, 208, 477)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 1171)
[M::mem_pestat] mean and std.dev: (210.05, 149.30)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 1518)
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_pestat] skip orientation FF
[M::mem_pestat] skip orientation RF
[M::mem_process_seqs] Processed 560380 reads in 57.852 CPU sec, 7.649 real sec
[samclip] Processed 4500000 records...
[samclip] Processed 4600000 records...
[samclip] Processed 4700000 records...
[samclip] Processed 4800000 records...
[samclip] Processed 4900000 records...
[samclip] Processed 5000000 records...
[M::process] read 561118 sequences (80000284 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (17, 215190, 30, 7)
[M::mem_pestat] analyzing insert size distribution for orientation FF...
[M::mem_pestat] (25, 50, 75) percentile: (59, 155, 994)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 2864)
[M::mem_pestat] mean and std.dev: (226.00, 268.40)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 3799)
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (144, 193, 256)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 480)
[M::mem_pestat] mean and std.dev: (204.69, 80.28)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 592)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (158, 270, 566)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 1382)
[M::mem_pestat] mean and std.dev: (316.03, 196.77)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 1790)
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_pestat] skip orientation FF
[M::mem_pestat] skip orientation RF
[M::mem_process_seqs] Processed 559200 reads in 58.844 CPU sec, 7.776 real sec
[samclip] Processed 5100000 records...
[samclip] Processed 5200000 records...
[samclip] Processed 5300000 records...
[samclip] Processed 5400000 records...
[samclip] Processed 5500000 records...
[samclip] Processed 5600000 records...
[M::process] read 386992 sequences (55166266 bp)...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (8, 216838, 26, 4)
[M::mem_pestat] skip orientation FF as there are not enough pairs
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (142, 190, 251)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 469)
[M::mem_pestat] mean and std.dev: (201.17, 78.74)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 578)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (108, 271, 386)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 942)
[M::mem_pestat] mean and std.dev: (247.92, 173.35)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 1220)
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_pestat] skip orientation RF
[M::mem_process_seqs] Processed 561118 reads in 56.980 CPU sec, 7.607 real sec
[samclip] Processed 5700000 records...
[samclip] Processed 5800000 records...
[samclip] Processed 5900000 records...
[samclip] Processed 6000000 records...
[samclip] Processed 6100000 records...
[M::mem_pestat] # candidate unique pairs for (FF, FR, RF, RR): (12, 149409, 30, 3)
[M::mem_pestat] analyzing insert size distribution for orientation FF...
[M::mem_pestat] (25, 50, 75) percentile: (32, 118, 291)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 809)
[M::mem_pestat] mean and std.dev: (155.17, 172.52)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 1068)
[M::mem_pestat] analyzing insert size distribution for orientation FR...
[M::mem_pestat] (25, 50, 75) percentile: (141, 190, 250)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 468)
[M::mem_pestat] mean and std.dev: (200.58, 78.35)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 577)
[M::mem_pestat] analyzing insert size distribution for orientation RF...
[M::mem_pestat] (25, 50, 75) percentile: (119, 257, 551)
[M::mem_pestat] low and high boundaries for computing mean and std.dev: (1, 1415)
[M::mem_pestat] mean and std.dev: (287.69, 206.17)
[M::mem_pestat] low and high boundaries for proper pairs: (1, 1847)
[M::mem_pestat] skip orientation RR as there are not enough pairs
[M::mem_pestat] skip orientation FF
[M::mem_pestat] skip orientation RF
[M::mem_process_seqs] Processed 386992 reads in 38.692 CPU sec, 4.954 real sec
[samclip] Processed 6200000 records...
[samclip] Processed 6300000 records...
[samclip] Processed 6400000 records...
[samclip] Processed 6500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:strain02\tSM:strain02 -t 8 reference/ref.fa /project/vdputten/SNP_pipeline/output/trimmed_illumina/strain02_1_trimmed.fastq.gz /project/vdputten/SNP_pipeline/output/trimmed_illumina/strain02_2_trimmed.fastq.gz
[main] Real time: 92.767 sec; CPU: 675.532 sec
[samclip] Total SAM records 6569731, removed 395095, allowed 167983, passed 6174636
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[21:14:30] Running: samtools index snps.bam 2>> snps.log
[21:14:33] Running: fasta_generate_regions.py reference/ref.fa.fai 352690 > reference/ref.txt 2>> snps.log
[21:14:33] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[21:15:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 173
          no. right trimmed                     : 474
          no. left and right trimmed            : 74
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 721

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 721
       total no. variants observed              : 80033
       total no. reference observed             : 0

Time elapsed: 1.30s

[21:15:41] Running: snpEff ann -noLog -noStats -no-downstream -no-upstream -no-utr -c reference/snpeff.config -dataDir . ref snps.filt.vcf > snps.vcf 2>> snps.log
[21:15:46] Running: /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[21:15:51] Running: /project/vdputten/SNP_pipeline/.snakemake/conda/ea2788ee/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[21:15:52] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[21:15:53] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[21:15:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[21:15:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[21:15:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[21:15:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[21:15:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[21:15:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[21:16:20] Marked 2562 heterozygous sites with 'n'
[21:16:20] Creating extra output files: BED GFF CSV TXT HTML
[21:16:21] Identified 80033 variants.
[21:16:21] Deleting: reference/ref.fa.fai
[21:16:21] Deleting: reference/ref.fa.amb
[21:16:21] Deleting: reference/ref.fa.ann
[21:16:21] Deleting: reference/ref.fa.bwt
[21:16:21] Deleting: reference/ref.fa.pac
[21:16:21] Deleting: reference/ref.fa.sa
[21:16:21] Deleting: snps.bam
[21:16:21] Deleting: snps.bam.bai
[21:16:21] Deleting: snps.raw.vcf
[21:16:21] Deleting: snps.vcf.gz.csi
[21:16:21] Deleting: snps.vcf.gz
[21:16:21] Deleting: snps.consensus.fa
[21:16:21] Deleting: snps.consensus.subs.fa
[21:16:21] Deleting: ref.fa
[21:16:21] Removing folder: reference/genomes
[21:16:21] Removing folder: reference/ref
[21:16:21] Result folder: output/snippy_out/strain02
[21:16:21] Result files:
[21:16:21] * output/snippy_out/strain02/snps.aligned.fa
[21:16:21] * output/snippy_out/strain02/snps.bed
[21:16:21] * output/snippy_out/strain02/snps.csv
[21:16:21] * output/snippy_out/strain02/snps.filt.vcf
[21:16:21] * output/snippy_out/strain02/snps.gff
[21:16:21] * output/snippy_out/strain02/snps.html
[21:16:21] * output/snippy_out/strain02/snps.log
[21:16:21] * output/snippy_out/strain02/snps.subs.vcf
[21:16:21] * output/snippy_out/strain02/snps.tab
[21:16:21] * output/snippy_out/strain02/snps.txt
[21:16:21] * output/snippy_out/strain02/snps.vcf
[21:16:21] Walltime used: 4 minutes, 55 seconds
[21:16:21] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[21:16:21] Done.
